var HN = {};
HN.namespace = function(name) {
    var parts = name.split('.'), cur = HN;
    for (var p in parts) {
        if (! cur[parts[p]]) 
            cur[parts[p]] = {};
        cur  = cur[parts[p]];
    }
}

var Y = { 
    str       : "y", 
    coord     : "top",  
    dimension : "height",
    client    : "clientHeight",
    to_index  : function(x) { return x; }
};
var X = {
    str       : "x", 
    coord     : "left", 
    dimension : "width",
    client    : "clientWidth",
    to_index  : function(x) { return HN.Util.to_b26(x); }
};

HN.UP    = 1;
HN.DOWN  = 2;
HN.LEFT  = 3;
HN.RIGHT = 4;

/**
 * Key Constants
 */
HN.Keys = {};
HN.Keys.ENTER  = 13;
HN.Keys.DELETE = 46;
HN.Keys.UP     = 38;
HN.Keys.DOWN   = 40;
HN.Keys.LEFT   = 37;
HN.Keys.RIGHT  = 39;
HN.Keys.SHIFT  = 16;
HN.Keys.CTRL   = 17;
HN.Keys.TAB    = 9;
HN.Keys.ALT    = 18;
HN.Keys.BACKSPACE = 8;

/**
 * Constants relating to the current editing state of spreadsheet
 */
HN.States = {};
HN.States.DRAGGING = 1;
HN.States.SELECTED_RANGE = 2;
HN.States.SELECTED_CELL = 3;
HN.States.EDIT_LIGHT_CELL = 4;
HN.States.EDIT_LIGHT_RANGE = 5;
HN.States.EDIT_FULL_CELL = 6;
HN.States.NOT_EDITING = 7;
HN.States.COPY_URL = 8;

HN.BGCOLORS = ["FFFFFF", "CCCCCC", "999999", "666666", "333333", "000000", 
               "CC0000", "FF7E00", "FFCC00", "5D8AA8", "669900", "A020F0",
               "FFB7C5", "F7E98E", "FFFDD0", "CCCCFF", "77DD77", "DDBEC3"];

HN.FONTCOLORS = HN.BGCOLORS;

HN.COMBOCOLORS = [[["FFFFFF","000000"],["FFFFFF","000000"],["FFFFFF","4B4B4B"],["FFFFFF","979797"],["FFFFFF", "FFFFFF"],["FFFFFF", "000000"],["000000", "FFFFFF"],["000000", "000000"]],
[["DDDDDD","222222"],["DDDDDD","000000"],["DDDDDD","414141"],["DDDDDD","838383"],["FFFFFF", "DDDDDD"],["FFFFFF", "222222"],["000000", "DDDDDD"],["000000", "222222"]],
[["444444","BBBBBB"],["444444","FFFFFF"],["444444","CECECE"],["444444","9D9D9D"],["FFFFFF", "444444"],["FFFFFF", "BBBBBB"],["000000", "444444"],["000000", "BBBBBB"]],
[["2C2C2C","D3D3D3"],["2C2C2C","FFFFFF"],["2C2C2C","C9C9C9"],["2C2C2C","939393"],["FFFFFF", "2C2C2C"],["FFFFFF", "D3D3D3"],["000000", "2C2C2C"],["000000", "D3D3D3"]],
[["000000","FFFFFF"],["000000","FFFFFF"],["000000","BFBFBF"],["000000","7F7F7F"],["FFFFFF", "000000"],["FFFFFF", "FFFFFF"],["000000", "000000"],["000000", "FFFFFF"]],
[["998C41","6673BE"],["998C41","000000"],["998C41","2A2A2A"],["998C41","555555"],["FFFFFF", "998C41"],["FFFFFF", "6673BE"],["000000", "998C41"],["000000", "6673BE"]],
[["CCB119","334EE6"],["CCB119","000000"],["CCB119","373737"],["CCB119","6E6E6E"],["FFFFFF", "CCB119"],["FFFFFF", "334EE6"],["000000", "CCB119"],["000000", "334EE6"]],
[["FFA706","0058F9"],["FFA706","000000"],["FFA706","3A3A3A"],["FFA706","747474"],["FFFFFF", "FFA706"],["FFFFFF", "0058F9"],["000000", "FFA706"],["000000", "0058F9"]],
[["46CAFF","B93500"],["46CAFF","000000"],["46CAFF","2E2E2E"],["46CAFF","5D5D5D"],["FFFFFF", "46CAFF"],["FFFFFF", "B93500"],["000000", "46CAFF"],["000000", "B93500"]],
[["19C8CC","E63733"],["19C8CC","FFFFFF"],["19C8CC","DEDEDE"],["19C8CC","BEBEBE"],["FFFFFF", "19C8CC"],["FFFFFF", "E63733"],["000000", "19C8CC"],["000000", "E63733"]],
[["997C43","6683BC"],["997C43","FFFFFF"],["997C43","DDDDDD"],["997C43","BBBBBB"],["FFFFFF", "997C43"],["FFFFFF", "6683BC"],["000000", "997C43"],["000000", "6683BC"]],
[["CC911C","336EE3"],["CC911C","000000"],["CC911C","303030"],["CC911C","616161"],["FFFFFF", "CC911C"],["FFFFFF", "336EE3"],["000000", "CC911C"],["000000", "336EE3"]],
[["FF6E0A","0091F5"],["FF6E0A","000000"],["FF6E0A","2F2F2F"],["FF6E0A","5E5E5E"],["FFFFFF", "FF6E0A"],["FFFFFF", "0091F5"],["000000", "FF6E0A"],["000000", "0091F5"]],
[["4AFFD9","B50026"],["4AFFD9","000000"],["4AFFD9","393939"],["4AFFD9","737373"],["FFFFFF", "4AFFD9"],["FFFFFF", "B50026"],["000000", "4AFFD9"],["000000", "B50026"]],
[["1CCC75","E3338A"],["1CCC75","000000"],["1CCC75","2A2A2A"],["1CCC75","555555"],["FFFFFF", "1CCC75"],["FFFFFF", "E3338A"],["000000", "1CCC75"],["000000", "E3338A"]],
[["996042","669FBD"],["996042","FFFFFF"],["996042","D8D8D8"],["996042","B2B2B2"],["FFFFFF", "996042"],["FFFFFF", "669FBD"],["000000", "996042"],["000000", "669FBD"]],
[["CC591B","33A6E4"],["CC591B","FFFFFF"],["CC591B","DBDBDB"],["CC591B","B8B8B8"],["FFFFFF", "CC591B"],["FFFFFF", "33A6E4"],["000000", "CC591B"],["000000", "33A6E4"]],
[["FF1608","00E9F7"],["FF1608","FFFFFF"],["FF1608","D5D5D5"],["FF1608","ACACAC"],["FFFFFF", "FF1608"],["FFFFFF", "00E9F7"],["000000", "FF1608"],["000000", "00E9F7"]],
[["48FF5C","B700A3"],["48FF5C","000000"],["48FF5C","393939"],["48FF5C","727272"],["FFFFFF", "48FF5C"],["FFFFFF", "B700A3"],["000000", "48FF5C"],["000000", "B700A3"]],
[["41CC1B","BE33E4"],["41CC1B","000000"],["41CC1B","2E2E2E"],["41CC1B","5D5D5D"],["FFFFFF", "41CC1B"],["FFFFFF", "BE33E4"],["000000", "41CC1B"],["000000", "BE33E4"]],
[["994E48","66B1B7"],["994E48","FFFFFF"],["994E48","D6D6D6"],["994E48","ADADAD"],["FFFFFF", "994E48"],["FFFFFF", "66B1B7"],["000000", "994E48"],["000000", "66B1B7"]],
[["CC3023","33CFDC"],["CC3023","FFFFFF"],["CC3023","D5D5D5"],["CC3023","ACACAC"],["FFFFFF", "CC3023"],["FFFFFF", "33CFDC"],["000000", "CC3023"],["000000", "33CFDC"]],
[["FF12BE","00ED41"],["FF12BE","FFFFFF"],["FF12BE","D5D5D5"],["FF12BE","ABABAB"],["FFFFFF", "FF12BE"],["FFFFFF", "00ED41"],["000000", "FF12BE"],["000000", "00ED41"]],
[["A9FF51","5600AE"],["A9FF51","000000"],["A9FF51","434343"],["A9FF51","868686"],["FFFFFF", "A9FF51"],["FFFFFF", "5600AE"],["000000", "A9FF51"],["000000", "5600AE"]],
[["B4CC23","4B33DC"],["B4CC23","000000"],["B4CC23","3A3A3A"],["B4CC23","747474"],["FFFFFF", "B4CC23"],["FFFFFF", "4B33DC"],["000000", "B4CC23"],["000000", "4B33DC"]],
[["993F7D","66C082"],["993F7D","FFFFFF"],["993F7D","D4D4D4"],["993F7D","A9A9A9"],["FFFFFF", "993F7D"],["FFFFFF", "66C082"],["000000", "993F7D"],["000000", "66C082"]],
[["CC1693","33E96C"],["CC1693","FFFFFF"],["CC1693","D1D1D1"],["CC1693","A4A4A4"],["FFFFFF", "CC1693"],["FFFFFF", "33E96C"],["000000", "CC1693"],["000000", "33E96C"]],
[["A102FF","5EFD00"],["A102FF","FFFFFF"],["A102FF","CBCBCB"],["A102FF","989898"],["FFFFFF", "A102FF"],["FFFFFF", "5EFD00"],["000000", "A102FF"],["000000", "5EFD00"]],
[["FFF542","000ABD"],["FFF542","000000"],["FFF542","494949"],["FFF542","939393"],["FFFFFF", "FFF542"],["FFFFFF", "000ABD"],["000000", "FFF542"],["000000", "000ABD"]],
[["CCB016","334FE9"],["CCB016","000000"],["CCB016","373737"],["CCB016","6E6E6E"],["FFFFFF", "CCB016"],["FFFFFF", "334FE9"],["000000", "CCB016"],["000000", "334FE9"]],
[["8F4099","70BF66"],["8F4099","FFFFFF"],["8F4099","D3D3D3"],["8F4099","A7A7A7"],["FFFFFF", "8F4099"],["FFFFFF", "70BF66"],["000000", "8F4099"],["000000", "70BF66"]],
[["B718CC","48E733"],["B718CC","FFFFFF"],["B718CC","D0D0D0"],["B718CC","A2A2A2"],["FFFFFF", "B718CC"],["FFFFFF", "48E733"],["000000", "B718CC"],["000000", "48E733"]],
[["5904FF","A6FB00"],["5904FF","FFFFFF"],["5904FF","C6C6C6"],["5904FF","8E8E8E"],["FFFFFF", "5904FF"],["FFFFFF", "A6FB00"],["000000", "5904FF"],["000000", "A6FB00"]],
[["FFE244","001DBB"],["FFE244","000000"],["FFE244","454545"],["FFE244","8B8B8B"],["FFFFFF", "FFE244"],["FFFFFF", "001DBB"],["000000", "FFE244"],["000000", "001DBB"]],
[["CC9E18","3361E7"],["CC9E18","000000"],["CC9E18","333333"],["CC9E18","676767"],["FFFFFF", "CC9E18"],["FFFFFF", "3361E7"],["000000", "CC9E18"],["000000", "3361E7"]],
[["6C4199","93BE66"],["6C4199","FFFFFF"],["6C4199","D0D0D0"],["6C4199","A2A2A2"],["FFFFFF", "6C4199"],["FFFFFF", "93BE66"],["000000", "6C4199"],["000000", "93BE66"]],
[["7219CC","8DE633"],["7219CC","FFFFFF"],["7219CC","CBCBCB"],["7219CC","989898"],["FFFFFF", "7219CC"],["FFFFFF", "8DE633"],["000000", "7219CC"],["000000", "8DE633"]],
[["0612FF","F9ED00"],["0612FF","FFFFFF"],["0612FF","C2C2C2"],["0612FF","858585"],["FFFFFF", "0612FF"],["FFFFFF", "F9ED00"],["000000", "0612FF"],["000000", "F9ED00"]],
[["FFC746","0038B9"],["FFC746","000000"],["FFC746","404040"],["FFC746","818181"],["FFFFFF", "FFC746"],["FFFFFF", "0038B9"],["000000", "FFC746"],["000000", "0038B9"]],
[["CC8419","337BE6"],["CC8419","000000"],["CC8419","2E2E2E"],["CC8419","5C5C5C"],["FFFFFF", "CC8419"],["FFFFFF", "337BE6"],["000000", "CC8419"],["000000", "337BE6"]],
[["424799","BDB866"],["424799","FFFFFF"],["424799","CECECE"],["424799","9E9E9E"],["FFFFFF", "424799"],["FFFFFF", "BDB866"],["000000", "424799"],["000000", "BDB866"]],
[["1B25CC","E4DA33"],["1B25CC","FFFFFF"],["1B25CC","C6C6C6"],["1B25CC","8E8E8E"],["FFFFFF", "1B25CC"],["FFFFFF", "E4DA33"],["000000", "1B25CC"],["000000", "E4DA33"]],
[["0998FF","F66700"],["0998FF","FFFFFF"],["0998FF","D6D6D6"],["0998FF","ADADAD"],["FFFFFF", "0998FF"],["FFFFFF", "F66700"],["000000", "0998FF"],["000000", "F66700"]],
[["FF9B48","0064B7"],["FF9B48","000000"],["FF9B48","383838"],["FF9B48","707070"],["FFFFFF", "FF9B48"],["FFFFFF", "0064B7"],["000000", "FF9B48"],["000000", "0064B7"]],
[["CC521B","33ADE4"],["CC521B","FFFFFF"],["CC521B","DADADA"],["CC521B","B6B6B6"],["FFFFFF", "CC521B"],["FFFFFF", "33ADE4"],["000000", "CC521B"],["000000", "33ADE4"]],
[["3D6C99","C29366"],["3D6C99","FFFFFF"],["3D6C99","D3D3D3"],["3D6C99","A8A8A8"],["FFFFFF", "3D6C99"],["FFFFFF", "C29366"],["000000", "3D6C99"],["000000", "C29366"]],
[["1473CC","EB8C33"],["1473CC","FFFFFF"],["1473CC","D1D1D1"],["1473CC","A4A4A4"],["FFFFFF", "1473CC"],["FFFFFF", "EB8C33"],["000000", "1473CC"],["000000", "EB8C33"]],
[["00FFF4","FF000B"],["00FFF4","000000"],["00FFF4","323232"],["00FFF4","646464"],["FFFFFF", "00FFF4"],["FFFFFF", "FF000B"],["000000", "00FFF4"],["000000", "FF000B"]],
[["FF6640","0099BF"],["FF6640","000000"],["FF6640","2D2D2D"],["FF6640","5B5B5B"],["FFFFFF", "FF6640"],["FFFFFF", "0099BF"],["000000", "FF6640"],["000000", "0099BF"]],
[["CC1F14","33E0EB"],["CC1F14","FFFFFF"],["CC1F14","D3D3D3"],["CC1F14","A7A7A7"],["FFFFFF", "CC1F14"],["FFFFFF", "33E0EB"],["000000", "CC1F14"],["000000", "33E0EB"]],
[["3D9992","C2666D"],["3D9992","FFFFFF"],["3D9992","DADADA"],["3D9992","B5B5B5"],["FFFFFF", "3D9992"],["FFFFFF", "C2666D"],["000000", "3D9992"],["000000", "C2666D"]],
[["14CCBE","EB3341"],["14CCBE","FFFFFF"],["14CCBE","DEDEDE"],["14CCBE","BEBEBE"],["FFFFFF", "14CCBE"],["FFFFFF", "EB3341"],["000000", "14CCBE"],["000000", "EB3341"]],
[["00FF5C","FF00A3"],["00FF5C","000000"],["00FF5C","323232"],["00FF5C","646464"],["FFFFFF", "00FF5C"],["FFFFFF", "FF00A3"],["000000", "00FF5C"],["000000", "FF00A3"]],
[["FF4085","00BF7A"],["FF4085","FFFFFF"],["FF4085","DBDBDB"],["FF4085","B8B8B8"],["FFFFFF", "FF4085"],["FFFFFF", "00BF7A"],["000000", "FF4085"],["000000", "00BF7A"]],
[["CC14B3","33EB4C"],["CC14B3","FFFFFF"],["CC14B3","D1D1D1"],["CC14B3","A4A4A4"],["FFFFFF", "CC14B3"],["FFFFFF", "33EB4C"],["000000", "CC14B3"],["000000", "33EB4C"]],
[["3D995E","C266A1"],["3D995E","FFFFFF"],["3D995E","DADADA"],["3D995E","B5B5B5"],["FFFFFF", "3D995E"],["FFFFFF", "C266A1"],["000000", "3D995E"],["000000", "C266A1"]],
[["14CC55","EB33AA"],["14CC55","FFFFFF"],["14CC55","DEDEDE"],["14CC55","BEBEBE"],["FFFFFF", "14CC55"],["FFFFFF", "EB33AA"],["000000", "14CC55"],["000000", "EB33AA"]],
[["43FF00","BC00FF"],["43FF00","000000"],["43FF00","383838"],["43FF00","717171"],["FFFFFF", "43FF00"],["FFFFFF", "BC00FF"],["000000", "43FF00"],["000000", "BC00FF"]],
[["D840FF","27BF00"],["D840FF","FFFFFF"],["D840FF","D8D8D8"],["D840FF","B2B2B2"],["FFFFFF", "D840FF"],["FFFFFF", "27BF00"],["000000", "D840FF"],["000000", "27BF00"]],
[["7414CC","8BEB33"],["7414CC","FFFFFF"],["7414CC","CACACA"],["7414CC","969696"],["FFFFFF", "7414CC"],["FFFFFF", "8BEB33"],["000000", "7414CC"],["000000", "8BEB33"]],
[["4B993D","B466C2"],["4B993D","FFFFFF"],["4B993D","DBDBDB"],["4B993D","B7B7B7"],["FFFFFF", "4B993D"],["FFFFFF", "B466C2"],["000000", "4B993D"],["000000", "B466C2"]],
[["2FCC14","D033EB"],["2FCC14","000000"],["2FCC14","2C2C2C"],["2FCC14","595959"],["FFFFFF", "2FCC14"],["FFFFFF", "D033EB"],["000000", "2FCC14"],["000000", "D033EB"]],
[["D7FF00","2800FF"],["D7FF00","000000"],["D7FF00","474747"],["D7FF00","8F8F8F"],["FFFFFF", "D7FF00"],["FFFFFF", "2800FF"],["000000", "D7FF00"],["000000", "2800FF"]],
[["8140FF","7EBF00"],["8140FF","FFFFFF"],["8140FF","D2D2D2"],["8140FF","A5A5A5"],["FFFFFF", "8140FF"],["FFFFFF", "7EBF00"],["000000", "8140FF"],["000000", "7EBF00"]],
[["2114CC","DEEB33"],["2114CC","FFFFFF"],["2114CC","C4C4C4"],["2114CC","8A8A8A"],["FFFFFF", "2114CC"],["FFFFFF", "DEEB33"],["000000", "2114CC"],["000000", "DEEB33"]],
[["998E87","667178"],["998E87","000000"],["998E87","2B2B2B"],["998E87","565656"],["FFFFFF", "998E87"],["FFFFFF", "667178"],["000000", "998E87"],["000000", "667178"]],
[["CC824E","337DB1"],["CC824E","000000"],["CC824E","2E2E2E"],["CC824E","5C5C5C"],["FFFFFF", "CC824E"],["FFFFFF", "337DB1"],["000000", "CC824E"],["000000", "337DB1"]],
[["FFEF7B","001084"],["FFEF7B","000000"],["FFEF7B","484848"],["FFEF7B","919191"],["FFFFFF", "FFEF7B"],["FFFFFF", "001084"],["000000", "FFEF7B"],["000000", "001084"]],
[["BBFFCB","440034"],["BBFFCB","000000"],["BBFFCB","444444"],["BBFFCB","898989"],["FFFFFF", "BBFFCB"],["FFFFFF", "440034"],["000000", "BBFFCB"],["000000", "440034"]],
[["56CC4E","A933B1"],["56CC4E","000000"],["56CC4E","303030"],["56CC4E","616161"],["FFFFFF", "56CC4E"],["FFFFFF", "A933B1"],["000000", "56CC4E"],["000000", "A933B1"]],
[["887A99","778566"],["887A99","FFFFFF"],["887A99","DBDBDB"],["887A99","B7B7B7"],["FFFFFF", "887A99"],["FFFFFF", "778566"],["000000", "887A99"],["000000", "778566"]],
[["7E3CCC","81C333"],["7E3CCC","FFFFFF"],["7E3CCC","D1D1D1"],["7E3CCC","A4A4A4"],["FFFFFF", "7E3CCC"],["FFFFFF", "81C333"],["000000", "7E3CCC"],["000000", "81C333"]],
[["6572FF","9A8D00"],["6572FF","FFFFFF"],["6572FF","D7D7D7"],["6572FF","B0B0B0"],["FFFFFF", "6572FF"],["FFFFFF", "9A8D00"],["000000", "6572FF"],["000000", "9A8D00"]],
[["FFE2A4","001D5B"],["FFE2A4","000000"],["FFE2A4","454545"],["FFE2A4","8B8B8B"],["FFFFFF", "FFE2A4"],["FFFFFF", "001D5B"],["000000", "FFE2A4"],["000000", "001D5B"]],
[["68903C","976FC3"],["68903C","FFFFFF"],["68903C","DCDCDC"],["68903C","B9B9B9"],["FFFFFF", "68903C"],["FFFFFF", "976FC3"],["000000", "68903C"],["000000", "976FC3"]],
[["80998C","7F6673"],["80998C","000000"],["80998C","2A2A2A"],["80998C","555555"],["FFFFFF", "80998C"],["FFFFFF", "7F6673"],["000000", "80998C"],["000000", "7F6673"]],
[["45CC87","BA3378"],["45CC87","000000"],["45CC87","2F2F2F"],["45CC87","5E5E5E"],["FFFFFF", "45CC87"],["FFFFFF", "BA3378"],["000000", "45CC87"],["000000", "BA3378"]],
[["7EFF70","81008F"],["7EFF70","000000"],["7EFF70","3E3E3E"],["7EFF70","7D7D7D"],["FFFFFF", "7EFF70"],["FFFFFF", "81008F"],["000000", "7EFF70"],["000000", "81008F"]],
[["F9AFFF","065000"],["F9AFFF","000000"],["F9AFFF","3B3B3B"],["F9AFFF","767676"],["FFFFFF", "F9AFFF"],["FFFFFF", "065000"],["000000", "F9AFFF"],["000000", "065000"]],
[["9D45CC","62BA33"],["9D45CC","FFFFFF"],["9D45CC","D5D5D5"],["9D45CC","ABABAB"],["FFFFFF", "9D45CC"],["FFFFFF", "62BA33"],["000000", "9D45CC"],["000000", "62BA33"]]];




