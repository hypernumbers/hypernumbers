var HN = {};
HN.namespace = function(name) {
    var parts = name.split('.'), cur = HN;
    for (var p in parts) {
        if (! cur[parts[p]]) 
            cur[parts[p]] = {};
        cur  = cur[parts[p]];
    }
}

var Y = { 
    str       : "y", 
    coord     : "top",  
    dimension : "height",
    client    : "clientHeight",
    to_index  : function(x) { return x; }
};
var X = {
    str       : "x", 
    coord     : "left", 
    dimension : "width",
    client    : "clientWidth",
    to_index  : function(x) { return HN.Util.to_b26(x); }
};

HN.UP    = 1;
HN.DOWN  = 2;
HN.LEFT  = 3;
HN.RIGHT = 4;

/**
 * Key Constants
 */
HN.Keys = {};
HN.Keys.ENTER  = 13;
HN.Keys.DELETE = 46;
HN.Keys.UP     = 38;
HN.Keys.DOWN   = 40;
HN.Keys.LEFT   = 37;
HN.Keys.RIGHT  = 39;
HN.Keys.SHIFT  = 16;
HN.Keys.CTRL   = 17;
HN.Keys.TAB    = 9;
HN.Keys.ALT    = 18;
HN.Keys.BACKSPACE = 8;

/**
 * Constants relating to the current editing state of spreadsheet
 */
HN.States = {};
HN.States.DRAGGING = 1;
HN.States.SELECTED_RANGE = 2;
HN.States.SELECTED_CELL = 3;
HN.States.EDIT_LIGHT_CELL = 4;
HN.States.EDIT_LIGHT_RANGE = 5;
HN.States.EDIT_FULL_CELL = 6;
HN.States.NOT_EDITING = 7;
HN.States.COPY_URL = 8;

HN.BGCOLORS = ["FFFFFF", "CCCCCC", "999999", "666666", "333333", "000000", 
               "CC0000", "FF7E00", "FFCC00", "5D8AA8", "669900", "A020F0",
               "FFB7C5", "F7E98E", "FFFDD0", "CCCCFF", "77DD77", "DDBEC3"];

HN.FONTCOLORS = HN.BGCOLORS;

HN.COMBOCOLORS = 
[[["FFFFFF","000000"],["FFFFFF","000000"],["FFFFFF","555555"],["FFFFFF","AAAAAA"],["FFFFFF", "FFFFFF"],["FFFFFF", "000000"],["000000", "FFFFFF"],["000000", "000000"]],
[["DDDDDD","222222"],["DDDDDD","000000"],["DDDDDD","494949"],["DDDDDD","939393"],["FFFFFF", "DDDDDD"],["FFFFFF", "222222"],["000000", "DDDDDD"],["000000", "222222"]],
[["444444","BBBBBB"],["444444","FFFFFF"],["444444","D0D0D0"],["444444","A1A1A1"],["FFFFFF", "444444"],["FFFFFF", "BBBBBB"],["000000", "444444"],["000000", "BBBBBB"]],
[["2C2C2C","D3D3D3"],["2C2C2C","FFFFFF"],["2C2C2C","CACACA"],["2C2C2C","959595"],["FFFFFF", "2C2C2C"],["FFFFFF", "D3D3D3"],["000000", "2C2C2C"],["000000", "D3D3D3"]],
[["000000","FFFFFF"],["000000","FFFFFF"],["000000","BFBFBF"],["000000","7F7F7F"],["FFFFFF", "000000"],["FFFFFF", "FFFFFF"],["000000", "000000"],["000000", "FFFFFF"]],
[["998C41","6673BE"],["998C41","000000"],["998C41","2D2D2D"],["998C41","5A5A5A"],["FFFFFF", "998C41"],["FFFFFF", "6673BE"],["000000", "998C41"],["000000", "6673BE"]],
[["CCB119","334EE6"],["CCB119","000000"],["CCB119","383838"],["CCB119","707070"],["FFFFFF", "CCB119"],["FFFFFF", "334EE6"],["000000", "CCB119"],["000000", "334EE6"]],
[["FFA706","0058F9"],["FFA706","000000"],["FFA706","3A3A3A"],["FFA706","757575"],["FFFFFF", "FFA706"],["FFFFFF", "0058F9"],["000000", "FFA706"],["000000", "0058F9"]],
[["46CAFF","B93500"],["46CAFF","000000"],["46CAFF","383838"],["46CAFF","707070"],["FFFFFF", "46CAFF"],["FFFFFF", "B93500"],["000000", "46CAFF"],["000000", "B93500"]],
[["19C8CC","E63733"],["19C8CC","000000"],["19C8CC","313131"],["19C8CC","626262"],["FFFFFF", "19C8CC"],["FFFFFF", "E63733"],["000000", "19C8CC"],["000000", "E63733"]],
[["997C43","6683BC"],["997C43","FFFFFF"],["997C43","DEDEDE"],["997C43","BEBEBE"],["FFFFFF", "997C43"],["FFFFFF", "6683BC"],["000000", "997C43"],["000000", "6683BC"]],
[["CC911C","336EE3"],["CC911C","000000"],["CC911C","313131"],["CC911C","636363"],["FFFFFF", "CC911C"],["FFFFFF", "336EE3"],["000000", "CC911C"],["000000", "336EE3"]],
[["FF6E0A","0091F5"],["FF6E0A","000000"],["FF6E0A","2F2F2F"],["FF6E0A","5F5F5F"],["FFFFFF", "FF6E0A"],["FFFFFF", "0091F5"],["000000", "FF6E0A"],["000000", "0091F5"]],
[["4AFFD9","B50026"],["4AFFD9","000000"],["4AFFD9","414141"],["4AFFD9","838383"],["FFFFFF", "4AFFD9"],["FFFFFF", "B50026"],["000000", "4AFFD9"],["000000", "B50026"]],
[["1CCC75","E3338A"],["1CCC75","000000"],["1CCC75","2F2F2F"],["1CCC75","5E5E5E"],["FFFFFF", "1CCC75"],["FFFFFF", "E3338A"],["000000", "1CCC75"],["000000", "E3338A"]],
[["996042","669FBD"],["996042","FFFFFF"],["996042","DADADA"],["996042","B6B6B6"],["FFFFFF", "996042"],["FFFFFF", "669FBD"],["000000", "996042"],["000000", "669FBD"]],
[["CC591B","33A6E4"],["CC591B","FFFFFF"],["CC591B","DCDCDC"],["CC591B","B9B9B9"],["FFFFFF", "CC591B"],["FFFFFF", "33A6E4"],["000000", "CC591B"],["000000", "33A6E4"]],
[["FF1608","00E9F7"],["FF1608","FFFFFF"],["FF1608","D5D5D5"],["FF1608","ACACAC"],["FFFFFF", "FF1608"],["FFFFFF", "00E9F7"],["000000", "FF1608"],["000000", "00E9F7"]],
[["48FF5C","B700A3"],["48FF5C","000000"],["48FF5C","3C3C3C"],["48FF5C","797979"],["FFFFFF", "48FF5C"],["FFFFFF", "B700A3"],["000000", "48FF5C"],["000000", "B700A3"]],
[["41CC1B","BE33E4"],["41CC1B","000000"],["41CC1B","2F2F2F"],["41CC1B","5F5F5F"],["FFFFFF", "41CC1B"],["FFFFFF", "BE33E4"],["000000", "41CC1B"],["000000", "BE33E4"]],
[["994E48","66B1B7"],["994E48","FFFFFF"],["994E48","D8D8D8"],["994E48","B1B1B1"],["FFFFFF", "994E48"],["FFFFFF", "66B1B7"],["000000", "994E48"],["000000", "66B1B7"]],
[["CC3023","33CFDC"],["CC3023","FFFFFF"],["CC3023","D6D6D6"],["CC3023","AEAEAE"],["FFFFFF", "CC3023"],["FFFFFF", "33CFDC"],["000000", "CC3023"],["000000", "33CFDC"]],
[["FF12BE","00ED41"],["FF12BE","FFFFFF"],["FF12BE","DADADA"],["FF12BE","B5B5B5"],["FFFFFF", "FF12BE"],["FFFFFF", "00ED41"],["000000", "FF12BE"],["000000", "00ED41"]],
[["A9FF51","5600AE"],["A9FF51","000000"],["A9FF51","464646"],["A9FF51","8C8C8C"],["FFFFFF", "A9FF51"],["FFFFFF", "5600AE"],["000000", "A9FF51"],["000000", "5600AE"]],
[["B4CC23","4B33DC"],["B4CC23","000000"],["B4CC23","3B3B3B"],["B4CC23","767676"],["FFFFFF", "B4CC23"],["FFFFFF", "4B33DC"],["000000", "B4CC23"],["000000", "4B33DC"]],
[["993F7D","66C082"],["993F7D","FFFFFF"],["993F7D","D7D7D7"],["993F7D","AFAFAF"],["FFFFFF", "993F7D"],["FFFFFF", "66C082"],["000000", "993F7D"],["000000", "66C082"]],
[["CC1693","33E96C"],["CC1693","FFFFFF"],["CC1693","D5D5D5"],["CC1693","ACACAC"],["FFFFFF", "CC1693"],["FFFFFF", "33E96C"],["000000", "CC1693"],["000000", "33E96C"]],
[["A102FF","5EFD00"],["A102FF","FFFFFF"],["A102FF","D2D2D2"],["A102FF","A6A6A6"],["FFFFFF", "A102FF"],["FFFFFF", "5EFD00"],["000000", "A102FF"],["000000", "5EFD00"]],
[["FFF542","000ABD"],["FFF542","000000"],["FFF542","4C4C4C"],["FFF542","989898"],["FFFFFF", "FFF542"],["FFFFFF", "000ABD"],["000000", "FFF542"],["000000", "000ABD"]],
[["CCB016","334FE9"],["CCB016","000000"],["CCB016","373737"],["CCB016","6F6F6F"],["FFFFFF", "CCB016"],["FFFFFF", "334FE9"],["000000", "CCB016"],["000000", "334FE9"]],
[["8F4099","70BF66"],["8F4099","FFFFFF"],["8F4099","D7D7D7"],["8F4099","B0B0B0"],["FFFFFF", "8F4099"],["FFFFFF", "70BF66"],["000000", "8F4099"],["000000", "70BF66"]],
[["B718CC","48E733"],["B718CC","FFFFFF"],["B718CC","D6D6D6"],["B718CC","ADADAD"],["FFFFFF", "B718CC"],["FFFFFF", "48E733"],["000000", "B718CC"],["000000", "48E733"]],
[["5904FF","A6FB00"],["5904FF","FFFFFF"],["5904FF","CDCDCD"],["5904FF","9C9C9C"],["FFFFFF", "5904FF"],["FFFFFF", "A6FB00"],["000000", "5904FF"],["000000", "A6FB00"]],
[["FFE244","001DBB"],["FFE244","000000"],["FFE244","484848"],["FFE244","909090"],["FFFFFF", "FFE244"],["FFFFFF", "001DBB"],["000000", "FFE244"],["000000", "001DBB"]],
[["CC9E18","3361E7"],["CC9E18","000000"],["CC9E18","343434"],["CC9E18","686868"],["FFFFFF", "CC9E18"],["FFFFFF", "3361E7"],["000000", "CC9E18"],["000000", "3361E7"]],
[["6C4199","93BE66"],["6C4199","FFFFFF"],["6C4199","D5D5D5"],["6C4199","ABABAB"],["FFFFFF", "6C4199"],["FFFFFF", "93BE66"],["000000", "6C4199"],["000000", "93BE66"]],
[["7219CC","8DE633"],["7219CC","FFFFFF"],["7219CC","D1D1D1"],["7219CC","A3A3A3"],["FFFFFF", "7219CC"],["FFFFFF", "8DE633"],["000000", "7219CC"],["000000", "8DE633"]],
[["0612FF","F9ED00"],["0612FF","FFFFFF"],["0612FF","C9C9C9"],["0612FF","939393"],["FFFFFF", "0612FF"],["FFFFFF", "F9ED00"],["000000", "0612FF"],["000000", "F9ED00"]],
[["FFC746","0038B9"],["FFC746","000000"],["FFC746","434343"],["FFC746","868686"],["FFFFFF", "FFC746"],["FFFFFF", "0038B9"],["000000", "FFC746"],["000000", "0038B9"]],
[["CC8419","337BE6"],["CC8419","000000"],["CC8419","2F2F2F"],["CC8419","5E5E5E"],["FFFFFF", "CC8419"],["FFFFFF", "337BE6"],["000000", "CC8419"],["000000", "337BE6"]],
[["424799","BDB866"],["424799","FFFFFF"],["424799","D2D2D2"],["424799","A6A6A6"],["FFFFFF", "424799"],["FFFFFF", "BDB866"],["000000", "424799"],["000000", "BDB866"]],
[["1B25CC","E4DA33"],["1B25CC","FFFFFF"],["1B25CC","CCCCCC"],["1B25CC","999999"],["FFFFFF", "1B25CC"],["FFFFFF", "E4DA33"],["000000", "1B25CC"],["000000", "E4DA33"]],
[["0998FF","F66700"],["0998FF","FFFFFF"],["0998FF","DDDDDD"],["0998FF","BBBBBB"],["FFFFFF", "0998FF"],["FFFFFF", "F66700"],["000000", "0998FF"],["000000", "F66700"]],
[["FF9B48","0064B7"],["FF9B48","000000"],["FF9B48","3A3A3A"],["FF9B48","757575"],["FFFFFF", "FF9B48"],["FFFFFF", "0064B7"],["000000", "FF9B48"],["000000", "0064B7"]],
[["CC521B","33ADE4"],["CC521B","FFFFFF"],["CC521B","DBDBDB"],["CC521B","B7B7B7"],["FFFFFF", "CC521B"],["FFFFFF", "33ADE4"],["000000", "CC521B"],["000000", "33ADE4"]],
[["3D6C99","C29366"],["3D6C99","FFFFFF"],["3D6C99","D7D7D7"],["3D6C99","B0B0B0"],["FFFFFF", "3D6C99"],["FFFFFF", "C29366"],["000000", "3D6C99"],["000000", "C29366"]],
[["1473CC","EB8C33"],["1473CC","FFFFFF"],["1473CC","D7D7D7"],["1473CC","AFAFAF"],["FFFFFF", "1473CC"],["FFFFFF", "EB8C33"],["000000", "1473CC"],["000000", "EB8C33"]],
[["00FFF4","FF000B"],["00FFF4","000000"],["00FFF4","3B3B3B"],["00FFF4","767676"],["FFFFFF", "00FFF4"],["FFFFFF", "FF000B"],["000000", "00FFF4"],["000000", "FF000B"]],
[["FF6640","0099BF"],["FF6640","000000"],["FF6640","2F2F2F"],["FF6640","5F5F5F"],["FFFFFF", "FF6640"],["FFFFFF", "0099BF"],["000000", "FF6640"],["000000", "0099BF"]],
[["CC1F14","33E0EB"],["CC1F14","FFFFFF"],["CC1F14","D3D3D3"],["CC1F14","A8A8A8"],["FFFFFF", "CC1F14"],["FFFFFF", "33E0EB"],["000000", "CC1F14"],["000000", "33E0EB"]],
[["3D9992","C2666D"],["3D9992","FFFFFF"],["3D9992","DEDEDE"],["3D9992","BDBDBD"],["FFFFFF", "3D9992"],["FFFFFF", "C2666D"],["000000", "3D9992"],["000000", "C2666D"]],
[["14CCBE","EB3341"],["14CCBE","000000"],["14CCBE","313131"],["14CCBE","626262"],["FFFFFF", "14CCBE"],["FFFFFF", "EB3341"],["000000", "14CCBE"],["000000", "EB3341"]],
[["00FF5C","FF00A3"],["00FF5C","000000"],["00FF5C","353535"],["00FF5C","6B6B6B"],["FFFFFF", "00FF5C"],["FFFFFF", "FF00A3"],["000000", "00FF5C"],["000000", "FF00A3"]],
[["FF4085","00BF7A"],["FF4085","000000"],["FF4085","2A2A2A"],["FF4085","555555"],["FFFFFF", "FF4085"],["FFFFFF", "00BF7A"],["000000", "FF4085"],["000000", "00BF7A"]],
[["CC14B3","33EB4C"],["CC14B3","FFFFFF"],["CC14B3","D6D6D6"],["CC14B3","ADADAD"],["FFFFFF", "CC14B3"],["FFFFFF", "33EB4C"],["000000", "CC14B3"],["000000", "33EB4C"]],
[["3D995E","C266A1"],["3D995E","FFFFFF"],["3D995E","DCDCDC"],["3D995E","BABABA"],["FFFFFF", "3D995E"],["FFFFFF", "C266A1"],["000000", "3D995E"],["000000", "C266A1"]],
[["14CC55","EB33AA"],["14CC55","000000"],["14CC55","2D2D2D"],["14CC55","5A5A5A"],["FFFFFF", "14CC55"],["FFFFFF", "EB33AA"],["000000", "14CC55"],["000000", "EB33AA"]],
[["43FF00","BC00FF"],["43FF00","000000"],["43FF00","383838"],["43FF00","717171"],["FFFFFF", "43FF00"],["FFFFFF", "BC00FF"],["000000", "43FF00"],["000000", "BC00FF"]],
[["D840FF","27BF00"],["D840FF","000000"],["D840FF","2B2B2B"],["D840FF","575757"],["FFFFFF", "D840FF"],["FFFFFF", "27BF00"],["000000", "D840FF"],["000000", "27BF00"]],
[["7414CC","8BEB33"],["7414CC","FFFFFF"],["7414CC","D0D0D0"],["7414CC","A2A2A2"],["FFFFFF", "7414CC"],["FFFFFF", "8BEB33"],["000000", "7414CC"],["000000", "8BEB33"]],
[["4B993D","B466C2"],["4B993D","FFFFFF"],["4B993D","DDDDDD"],["4B993D","BBBBBB"],["FFFFFF", "4B993D"],["FFFFFF", "B466C2"],["000000", "4B993D"],["000000", "B466C2"]],
[["2FCC14","D033EB"],["2FCC14","000000"],["2FCC14","2D2D2D"],["2FCC14","5B5B5B"],["FFFFFF", "2FCC14"],["FFFFFF", "D033EB"],["000000", "2FCC14"],["000000", "D033EB"]],
[["D7FF00","2800FF"],["D7FF00","000000"],["D7FF00","474747"],["D7FF00","8F8F8F"],["FFFFFF", "D7FF00"],["FFFFFF", "2800FF"],["000000", "D7FF00"],["000000", "2800FF"]],
[["8140FF","7EBF00"],["8140FF","FFFFFF"],["8140FF","D9D9D9"],["8140FF","B3B3B3"],["FFFFFF", "8140FF"],["FFFFFF", "7EBF00"],["000000", "8140FF"],["000000", "7EBF00"]],
[["2114CC","DEEB33"],["2114CC","FFFFFF"],["2114CC","CACACA"],["2114CC","959595"],["FFFFFF", "2114CC"],["FFFFFF", "DEEB33"],["000000", "2114CC"],["000000", "DEEB33"]],
[["998E87","667178"],["998E87","000000"],["998E87","303030"],["998E87","606060"],["FFFFFF", "998E87"],["FFFFFF", "667178"],["000000", "998E87"],["000000", "667178"]],
[["CC824E","337DB1"],["CC824E","000000"],["CC824E","303030"],["CC824E","616161"],["FFFFFF", "CC824E"],["FFFFFF", "337DB1"],["000000", "CC824E"],["000000", "337DB1"]],
[["FFEF7B","001084"],["FFEF7B","000000"],["FFEF7B","4D4D4D"],["FFEF7B","9A9A9A"],["FFFFFF", "FFEF7B"],["FFFFFF", "001084"],["000000", "FFEF7B"],["000000", "001084"]],
[["BBFFCB","440034"],["BBFFCB","000000"],["BBFFCB","4C4C4C"],["BBFFCB","989898"],["FFFFFF", "BBFFCB"],["FFFFFF", "440034"],["000000", "BBFFCB"],["000000", "440034"]],
[["56CC4E","A933B1"],["56CC4E","000000"],["56CC4E","333333"],["56CC4E","676767"],["FFFFFF", "56CC4E"],["FFFFFF", "A933B1"],["000000", "56CC4E"],["000000", "A933B1"]],
[["887A99","778566"],["887A99","000000"],["887A99","2B2B2B"],["887A99","565656"],["FFFFFF", "887A99"],["FFFFFF", "778566"],["000000", "887A99"],["000000", "778566"]],
[["7E3CCC","81C333"],["7E3CCC","FFFFFF"],["7E3CCC","D7D7D7"],["7E3CCC","AFAFAF"],["FFFFFF", "7E3CCC"],["FFFFFF", "81C333"],["000000", "7E3CCC"],["000000", "81C333"]],
[["6572FF","9A8D00"],["6572FF","FFFFFF"],["6572FF","DEDEDE"],["6572FF","BEBEBE"],["FFFFFF", "6572FF"],["FFFFFF", "9A8D00"],["000000", "6572FF"],["000000", "9A8D00"]],
[["FFE2A4","001D5B"],["FFE2A4","000000"],["FFE2A4","4B4B4B"],["FFE2A4","979797"],["FFFFFF", "FFE2A4"],["FFFFFF", "001D5B"],["000000", "FFE2A4"],["000000", "001D5B"]],
[["68903C","976FC3"],["68903C","FFFFFF"],["68903C","DDDDDD"],["68903C","BCBCBC"],["FFFFFF", "68903C"],["FFFFFF", "976FC3"],["000000", "68903C"],["000000", "976FC3"]],
[["80998C","7F6673"],["80998C","000000"],["80998C","303030"],["80998C","606060"],["FFFFFF", "80998C"],["FFFFFF", "7F6673"],["000000", "80998C"],["000000", "7F6673"]],
[["45CC87","BA3378"],["45CC87","000000"],["45CC87","333333"],["45CC87","676767"],["FFFFFF", "45CC87"],["FFFFFF", "BA3378"],["000000", "45CC87"],["000000", "BA3378"]],
[["7EFF70","81008F"],["7EFF70","000000"],["7EFF70","424242"],["7EFF70","858585"],["FFFFFF", "7EFF70"],["FFFFFF", "81008F"],["000000", "7EFF70"],["000000", "81008F"]],
[["F9AFFF","065000"],["F9AFFF","000000"],["F9AFFF","444444"],["F9AFFF","898989"],["FFFFFF", "F9AFFF"],["FFFFFF", "065000"],["000000", "F9AFFF"],["000000", "065000"]],
[["9D45CC","62BA33"],["9D45CC","FFFFFF"],["9D45CC","DADADA"],["9D45CC","B6B6B6"],["FFFFFF", "9D45CC"],["FFFFFF", "62BA33"],["000000", "9D45CC"],["000000", "62BA33"]]];

