<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<!-- autogenerated by 'erl2html2'. -->
<html>
<head><title>/home/dale/Desktop/hypernumbers/tests/system_test/range_test_SUITE.erl</title></head>

<body bgcolor="white" text="black" link="blue" vlink="purple" alink="red">
<pre>
    1:<i>%%%-----------------------------------------------------------------------------</i>
    2:<i>%%% File    : API_test_SUITE.erl</i>
    3:<i>%%% Author  : Gordon Guthrie &lt;gordonguthrie@localhost&gt;</i>
    4:<i>%%% Description :</i>
    5:<i>%%%</i>
    6:<i>%%% Created : 20 Oct 2007 by Gordon Guthrie &lt;gordonguthrie@localhost&gt;</i>
    7:<i>%%%-----------------------------------------------------------------------------</i>
    8:-<b>module</b>(range_test_SUITE).
    9:
<a name="10"></a>   10:<i>%% Note: This directive should only be used in test suites.</i>
   11:-<b>compile</b>(export_all).
   12:
   13:-<b>include</b>("ct.hrl").
   14:-<b>include</b>("../../include/spriki.hrl").
   15:
   16:<i>%% Test server callback functions</i>
   17:<i>%%------------------------------------------------------------------------------</i>
<a name=init_per_suite>   18:<b>init_per_suite</b></a>(Config) -&gt;
   19:    code:add_path("../../../../../ebin"),
<a name="20"></a>   20:    production_boot:start(),
   21:    bits:clear_db(),
   22:    Config.
   23:
<a name=end_per_suite>   24:<b>end_per_suite</b></a>(_Config) -&gt;
   25:    production_boot:stop(),
   26:    ok.
   27:
<a name=init_per_testcase>   28:<b>init_per_testcase</b></a>(_TestCase, Config) -&gt; Config.
<a name=end_per_testcase>   29:<b>end_per_testcase</b></a>(_TestCase, _Config) -&gt; ok.
<a name="30"></a>   30:
<a name=all>   31:<b>all</b></a>() -&gt; [range1,range2].
   32:
   33:<i>%% Test cases starts here.</i>
   34:<i>%%------------------------------------------------------------------------------</i>
<a name=range1>   35:<b>range1</b></a>() -&gt;      [{userdata,[{doc,"Description here"}]}].
<a name=range1>   36:<b>range1</b></a>(Config) when is_list(Config) -&gt;
   37:    test_util:expected(lists:duplicate(3,"a\nb\n1\n2"),post_data("a1:b2",{"post",
   38:        [{"action","create"},{"value",[{"cell","a"},{"cell","b"},{"cell","1"},{"cell","2"}]}]})).
   39:
<a name=range2><a name="40"></a>   40:<b>range2</b></a>() -&gt;      [{userdata,[{doc,"Description here"}]}].
<a name=range2>   41:<b>range2</b></a>(Config) when is_list(Config) -&gt;
   42:    hn_util:post("http://127.0.0.1:9000/test/a1?format=xml",
   43:        "&lt;post&gt;&lt;action&gt;create&lt;/action&gt;&lt;value&gt;99&lt;/value&gt;&lt;/post&gt;","text/xml"),
   44:    test_util:expected(lists:duplicate(3,"10\n99\n104\nError: divide by 0"),post_data("a1:b2",{"post",
   45:        [{"action","create"},{"value",[{"cell","=5+5"},{"cell","=/test/a1"},
   46:        {"cell","=/test/a1+5"},{"cell","=4/0"}]}]})).
   47:
   48:<i>%% Utilities</i>
   49:<i>%%------------------------------------------------------------------------------</i>
<a name=post_data><a name="50"></a>   50:<b>post_data</b></a>(Cell,Data) -&gt;
   51:    [post_data(Cell,Data,{list}),post_data(Cell,Data,{xml}),
   52:     post_data(Cell,Data,{json})].
   53:
<a name=post_data>   54:<b>post_data</b></a>(Cell,Data,Format) -&gt;
   55:
   56:    {PData,Type,FormatStr} = case Format of
   57:        {list} -&gt; {spriki:to_post(Data),"text/plain","list"};
   58:        {xml}  -&gt; {spriki:to_xml(Data), "text/xml",  "xml"};
   59:        {json} -&gt; {spriki:to_json(Data),"text/plain","json"}
<a name="60"></a>   60:    end,
   61:
   62:    Url = "http://127.0.0.1:9000/"++Cell++"?format="++FormatStr,
   63:    D = hn_util:post(Url,PData,Type),
   64:    
   65:    util2:flatten_data(Format,D).
   66:
</pre>
<hr size=1><i>The transformation of this file (67 lines) took 0.00 seconds</i><br>
</body>
</html>
